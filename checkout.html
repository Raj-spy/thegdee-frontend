<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" href=" https://github.com/Raj-spy/thegdee-frontend/blob/main/media/favicon-16x16.png?raw=true" type="image/png">

  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "st3jdhcox6");
</script>

  <title>Checkout</title>
  <style>
 /* Base: mobile-first */ :root{ --bg:#000; --panel:#111; --panel-2:#1b1b1b; --muted:#cfcfcf; --text:#fff; --accent:#00e68a; --border:#2d2d2d; } *{box-sizing:border-box} html,body{height:100%} body{ font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; background:var(--bg); color:var(--text); margin:0; /* space for fixed marquee height (~40px) */ padding:56px 12px 20px; line-height:1.4; } h1{ font-size:1.25rem; font-weight:700; text-align:center; margin:8px 0 16px; } h3{ font-size:1rem; margin:0 0 10px; } /* Marquee - fixed top */ .marquee-container{ position:fixed; top:0;left:0;right:0; z-index:9999; background:#000; color:#fff; border-bottom:1px solid #111; padding:10px 12px; overflow:hidden; white-space:nowrap; } .marquee{ display:inline-block; animation:scroll-left 18s linear infinite; font-size:0.9rem; font-weight:600; } @keyframes scroll-left{ 0%{transform:translateX(100%)} 100%{transform:translateX(-100%)} } /* Layout container */ .checkout-container{ display:grid; gap:16px; } /* Panels */ .checkout-form, .cart-details{ background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:14px; } /* Inputs */ .checkout-form input, .checkout-form select{ width:100%; padding:12px; margin:0 0 12px; background:var(--panel-2); border:1px solid var(--border); border-radius:8px; color:var(--text); font-size:0.95rem; outline:none; transition:border-color .2s ease, background .2s ease; } .checkout-form input:focus, .checkout-form select:focus{ border-color:#3a3a3a; background:#202020; } .checkout-form input::placeholder{color:#9a9a9a} /* Payment method block */ .payment-method{ width:100%; margin:14px 0 8px; } .payment-method div{ display:grid; gap:10px; background:var(--panel-2); border:1px solid var(--border); border-radius:10px; padding:12px; max-width:100%; box-shadow:none; margin:0; } .payment-method input[type="radio"]{display:none} .payment-method label{ display:flex; align-items:center; gap:10px; background:#222; color:#efefef; border:1px solid transparent; border-radius:8px; padding:12px; font-size:0.95rem; cursor:pointer; transition:background .2s ease, border-color .2s ease, color .2s ease; } .payment-method input[type="radio"]:checked + label{ border-color:var(--accent); color:var(--accent); background:#232323; } .payment-method label:hover{background:#242424} /* Submit button */ .submit-btn{ display:block; width:100%; background:#000; color:#fff; padding:14px 16px; font-size:1rem; font-weight:700; border:1.5px solid var(--accent); border-radius:10px; cursor:pointer; margin-top:12px; transition:transform .15s ease, box-shadow .2s ease, background .2s ease, color .2s ease; box-shadow:0 4px 10px rgba(0,230,138,0.15); } .submit-btn:active{transform:scale(0.99)} .submit-btn:hover{ background:#0a0a0a; color:var(--accent); box-shadow:0 0 0 3px rgba(0,230,138,0.12); } .submit-btn:disabled{ opacity:.6; cursor:not-allowed; box-shadow:none; } /* Loader */ .loader{ display:none; text-align:center; color:var(--accent); font-size:0.95rem; font-weight:600; margin-top:12px; animation:fadeIn .25s ease-in-out; } @keyframes fadeIn{ from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:translateY(0)} } /* Cart items */ .cart-item{ display:grid; grid-template-columns:72px 1fr; gap:12px; background:#141414; border:1px solid var(--border); border-radius:10px; padding:10px; margin:0 0 10px; } .cart-item img{ width:72px; height:72px; object-fit:cover; border-radius:8px; } .cart-item h4{ font-size:0.95rem; margin:0 0 6px; } .cart-item p{ font-size:0.9rem; color:#c9c9c9; margin:3px 0 0; } .cart-details h3{margin-bottom:8px} .cart-info{font-size:0.9rem; color:#bdbdbd} .total-price{ margin-top:8px; font-weight:800; color:var(--accent); font-size:1rem; } /* Better spacing on very small phones */ @media (max-width:380px){ body{padding-left:10px; padding-right:10px} .checkout-form, .cart-details{padding:12px} .payment-method label{padding:10px; font-size:0.9rem} .cart-item{grid-template-columns:64px 1fr; gap:10px} .cart-item img{width:64px; height:64px} } /* Tablet+ improvements (stack stays vertical; just increases spacing/size) */ @media (min-width:600px){ body{padding:60px 16px 24px} h1{font-size:1.35rem} .checkout-container{gap:18px} .checkout-form input, .checkout-form select{font-size:1rem} .payment-method label{font-size:1rem} } /* Desktop layout: two columns */ @media (min-width:900px){ .checkout-container{ grid-template-columns:1.1fr .9fr; align-items:start; } .checkout-form, .cart-details{padding:16px} } /* Respect reduced motion */ @media (prefers-reduced-motion: reduce){ .marquee{animation:none} .submit-btn, .payment-method label{transition:none} } </style>
</head>
   <!-- Marquee Section -->
   <div class="marquee-container">
    <div class="marquee">
      üì¢ COD orders include ‚Çπ100 delivery charge. Online payment has free delivery.
    </div>
  </div>

  
  <h1>Checkout</h1>

  <div class="checkout-container">
    <!-- User Details Form -->
    <div class="checkout-form">
      <h3>Enter Your Details</h3>
      <input type="text" id="user-name" placeholder="Your Name" required />
      <input type="text" id="user-address" placeholder="Your Address & Pincode" required />
      <input type="tel" id="user-phone" placeholder="Your Phone Number" required />
      
      <div class="payment-method">
        <div>
          <input type="radio" id="online-payment" name="payment" value="online" checked />
          <label for="online-payment">Online Payment</label>

          <input type="radio" id="cod" name="payment" value="cod" />
          <label for="cod">Cash On Delivery (COD)</label>
        </div>
      </div>

      <button class="submit-btn" id="submit-btn" onclick="submitCheckout()">Proceed to Payment</button>
      <div class="loader" id="loader">Processing your order...</div>
    </div>

    <!-- Cart Details -->
    <div class="cart-details">
      <h3>Your Cart</h3>
      <div id="cart-items"></div>
      <div class="total-price" id="final-total"></div>
    </div>
  </div>
  <script>
    const cartContainer = document.getElementById("cart-items");
   const finalTotalElement = document.getElementById("final-total");
   const loader = document.getElementById("loader");
   const submitBtn = document.getElementById("submit-btn");
   const paymentRadios = document.querySelectorAll('input[name="payment"]');
   
   let cartItems = [];
   try {
     cartItems = JSON.parse(localStorage.getItem("cart")) || [];
   } catch (error) {
     console.error("Invalid cart JSON:", error);
     localStorage.removeItem("cart");
   }
   
   let baseTotal = 0;
   let deliveryCharge = 0;
   let finalTotal = 0;
   
   function updateCartDisplay() {
     cartContainer.innerHTML = "";
     baseTotal = 0;
   
     if (!cartItems.length) {
       cartContainer.innerHTML = "<p>Your cart is empty.</p>";
       finalTotalElement.innerHTML = "";
       return;
     }
   
     cartItems.forEach(item => {
       const itemTotal = item.price * item.quantity;
       baseTotal += itemTotal;
   
       const div = document.createElement("div");
       div.className = "cart-item";
       div.innerHTML = `
         <img src="${item.image}" alt="${item.title}" />
         <div>
           <h4>${item.title}</h4>
           <p>Size: ${item.size}</p>
           <p>Quantity: ${item.quantity}</p>
           <p>Price: ‚Çπ${item.price} x ${item.quantity} = ‚Çπ${itemTotal}</p>
         </div>
       `;
       cartContainer.appendChild(div);
     });
   
     updateTotal();
   }
   
   function updateTotal() {
     const selectedPayment = document.querySelector('input[name="payment"]:checked');
     deliveryCharge = (selectedPayment?.value === "cod") ? 100 : 0;
     finalTotal = baseTotal + deliveryCharge;
   
     finalTotalElement.innerHTML = `
       <p>Subtotal: ‚Çπ${baseTotal}</p>
       <p>Delivery: ‚Çπ${deliveryCharge}</p>
       <strong>Total Amount: ‚Çπ${finalTotal}</strong>
     `;
   }
   
   paymentRadios.forEach(radio => {
     radio.addEventListener("change", updateTotal);
   });
   
   function validatePhoneNumber(phone) {
     return /^[6-9]\d{9}$/.test(phone);
   }
   
   async function submitCheckout() {
     const userName = document.getElementById("user-name").value.trim();
     const userAddress = document.getElementById("user-address").value.trim();
     const userPhone = document.getElementById("user-phone").value.trim();
     const selectedPayment = document.querySelector('input[name="payment"]:checked');
   
     if (!userName || !userAddress || !userPhone) {
       alert("Please fill in all the details.");
       return;
     }
   
     if (!validatePhoneNumber(userPhone)) {
       alert("Please enter a valid 10-digit phone number.");
       return;
     }
   
     if (!cartItems.length) {
       alert("Your cart is empty.");
       return;
     }
   
     loader.style.display = "block";
     submitBtn.disabled = true;
   
     const orderData = {
       name: userName,
       address: userAddress,
       phoneNumber: userPhone,
       paymentMethod: selectedPayment.value,
       orderstatus: "pending",
       totalAmount: finalTotal,
       products: cartItems.map(item => ({
         title: item.title,
         price: item.price,
         image: item.image,
         quantity: item.quantity,
         size: item.size,
       }))
     };
   
     localStorage.setItem("orderDetails", JSON.stringify(orderData));
   
     if (selectedPayment.value === "online") {
       // Razorpay payment integration
       const options = {
         key: "rzp_live_WWyP2tXTKoNhnA", // Your Razorpay Key ID
         amount: finalTotal * 100, // Amount in paise (multiply by 100)
         currency: "INR",
         name: "Thegdeeclothing",
         description: "Order Payment",
         image: "https://i.postimg.cc/yYnX81Sh/thegdee-logo-without-bg.png", // Your company logo URL
         handler: async function (paymentResponse) {
           console.log("Payment successful:", paymentResponse);
   
           const orderData = {
             name: userName,
             address: userAddress,
             phoneNumber: userPhone,
             paymentMethod: selectedPayment.value,
             orderstatus: "pending",
             totalAmount: finalTotal,
             razorpayPaymentId: paymentResponse.razorpay_payment_id, // Use paymentResponse here
             products: cartItems.map(item => ({
               title: item.title,
               price: item.price,
               image: item.image,
               quantity: item.quantity,
               size: item.size,
             }))
           };
   
           try {
             const res = await fetch("https://panel.thegdee.com/api/orders", { // Updated URL
               method: "POST",
               headers: { "Content-Type": "application/json" },
               body: JSON.stringify({ data: orderData })
             });
             const result = await res.json();
             if (res.ok) {
               alert("‚úÖ Order placed successfully!");
               localStorage.removeItem("cart");
               window.location.href = "confirmation.html"; // Redirect to confirmation page
             } else {
               console.error("Error sending order to Strapi:", result.error);
               alert("‚ùå Failed to place order.");
             }
           } catch (err) {
             console.error("Request failed:", err);
             alert("An error occurred.");
           }
         },
         prefill: {
           name: userName,
           email: "user@example.com", // Optionally, get the user's email
           contact: userPhone
         },
         theme: {
           color: "#F37254" // Customize the theme color of the payment window
         }
       };
   
       const rzp = new Razorpay(options);
       rzp.open();
     } else {
       // COD (Cash on Delivery) handling
       try {
         const response = await fetch("https://panel.thegdee.com/api/orders", { // Updated URL
           method: "POST",
           headers: { "Content-Type": "application/json" },
           body: JSON.stringify({ data: orderData })
         });
   
         const result = await response.json();
         loader.style.display = "none";
         submitBtn.disabled = false;
   
         if (response.ok) {
           localStorage.removeItem("cart");
           alert("‚úÖ Order placed successfully!");
           window.location.href = "confirmation.html";
         } else {
           console.error("Order error:", result);
           alert("‚ùå Failed to place order.");
         }
       } catch (err) {
         console.error("Request failed:", err);
         loader.style.display = "none";
         submitBtn.disabled = false;
         alert("An error occurred.");
       }
     }
   }
   
   // Initial load
   updateCartDisplay();
   
   </script>
   
</body>
</html>